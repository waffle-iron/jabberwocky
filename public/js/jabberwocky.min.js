"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}(),Auth=function(){function e(n){_classCallCheck(this,e),this.user=!1,this.auth=n,this.observer()}return _createClass(e,[{key:"createUser",value:function(e,n){this.auth.createUserWithEmailAndPassword(e,n).catch(function(e){return e.message})}},{key:"signIn",value:function(e,n){return this.auth.signInWithEmailAndPassword(e,n).catch(function(e){return errorMessage=e.message})}},{key:"signOut",value:function(){this.auth.signOut().then(function(){}).catch(function(e){})}},{key:"observer",value:function(){var e=this;this.auth.onAuthStateChanged(function(n){if(n){e.user=!0,document.getElementById("login").style.display="none";var t=document.getElementById("chat"),a=document.getElementById("main");a.innerHTML="";var s=document.importNode(t.content,!0);a.appendChild(s),document.getElementById("send").onclick=function(){var e=document.getElementById("msg");messages.send(e.value),e.value=""},messages.read("msgs")}else e.user=!1})}}]),e}(),_createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}(),Messages=function(){function e(n,t){_classCallCheck(this,e),this.database=n,this.aes=t}return _createClass(e,[{key:"send",value:function(e){return this.database.ref("messages/").push({date:Date(),message:e}).key}},{key:"read",value:function(e){var n=this;firebase.database().ref("messages/").on("child_added",function(t){n.update(e,t.val())})}},{key:"update",value:function(e,n){var t=document.getElementById(e);t.value+=n.date+"\n",t.value+=n.message+"\n",t.scrollTop=t.scrollHeight}}]),e}(),_createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}(),Aes=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"encrypt",value:function(e,n){return CryptoJS.AES.encrypt(e,n).toString()}},{key:"decrypt",value:function(e,n){return CryptoJS.AES.decrypt(e,n).toString(CryptoJS.enc.Utf8)}}]),e}(),auth=new Auth(firebase.auth()),database=firebase.database(),main=document.getElementById("main");if(console.log(auth.user),auth.user)console.log("logged in");else{var login=document.getElementById("login"),clone=document.importNode(login.content,!0);main.appendChild(clone);var loginBtn=document.getElementById("login__btn");loginBtn.onclick=function(){var e=document.getElementById("username"),n=document.getElementById("password");console.log("username",e.value);auth.signIn(e.value,n.value)}}var messages=new Messages(database,new Aes);