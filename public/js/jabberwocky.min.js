"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),Template=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"load",value:function(e,t){var n=document.getElementById(e+"__template"),a=document.getElementById(t+"__container"),r=document.importNode(n.content,!0);return a.appendChild(r),this}},{key:"empty",value:function(e){return document.getElementById(e+"__container").innerHTML="",this}},{key:"observe",value:function(e,t,n){}},{key:"listen",value:function(e,t,n){document.getElementById(e+"__button").onclick=function(){t[n]()}}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),User=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"register",value:function(){this.getValues("register")}},{key:"login",value:function(){this.getValues("login"),console.log(encryption.encrypt(this.email.value,"test"))}},{key:"logout",value:function(){}},{key:"getValues",value:function(e){this.email=document.getElementById(e+"_email__input"),this.password=document.getElementById(e+"_password__input")}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),Encryption=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"encrypt",value:function(e,t){return CryptoJS.AES.encrypt(e,t).toString()}},{key:"decrypt",value:function(e,t){return CryptoJS.AES.decrypt(e,t).toString(CryptoJS.enc.Utf8)}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),Message=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"send",value:function(){var e=document.getElementById("chat__message"),t=firebase.auth().currentUser.email;if(""!=e.value)return firebase.database().ref("messages/").push({date:Date(),user:t,message:Encryption.encrypt(e.value,t)}).key,e.value="",!1}},{key:"update",value:function(e,t){var n=document.getElementById(e),a=document.createElement("div"),r=document.createElement("span"),l=document.createElement("span"),c=document.createElement("span");a.className="msg",r.className="date",l.className="user",c.className="content";var o=new Date(t.date);o=o.getMonth()+1+"/"+o.getDate()+"/"+o.getFullYear();var s=document.createTextNode(t.user),u=document.createTextNode(o),i=document.createTextNode(Encryption.decrypt(t.message,t.user));r.appendChild(u),l.appendChild(s),c.appendChild(i),a.appendChild(l),a.appendChild(r),a.appendChild(c),n.appendChild(a),n.scrollTop=n.scrollHeight}}]),e}(),template=new Template,user=new User,message=new Message,email="";template.empty("main").load("login","main").listen("login",user,"login"),template.load("register","main"),firebase.auth().onAuthStateChanged(function(e){e&&(console.log(e),template.empty("main").load("chat","main"),template.listen("chat",message,"send"),firebase.database().ref("messages/").on("child_added",function(e){message.update("chat__messages",e.val())}))});