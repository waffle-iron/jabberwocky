"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),Template=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"load",value:function(e,t){var n=document.getElementById(e+"__template"),a=document.getElementById(t+"__container"),r=document.importNode(n.content,!0);return a.appendChild(r),this}},{key:"empty",value:function(e){return document.getElementById(e+"__container").innerHTML="",this}},{key:"observe",value:function(e,t,n){}},{key:"listen",value:function(e,t,n){return document.getElementById(e+"__button").onclick=function(){console.log(t),t[n]()}}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),User=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"register",value:function(){this.getValues("register")}},{key:"login",value:function(){return this.getValues("login"),firebase.auth().signInWithEmailAndPassword(this.email,this.password).catch(function(e){return errorMessage=e.message})}},{key:"logout",value:function(){firebase.auth().signOut().then(function(){}).catch(function(e){})}},{key:"getValues",value:function(e){this.email=document.getElementById(e+"_email__input").value,this.password=document.getElementById(e+"_password__input").value}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),Encryption=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"encrypt",value:function(e,t){return CryptoJS.AES.encrypt(e,t).toString()}},{key:"decrypt",value:function(e,t){return CryptoJS.AES.decrypt(e,t).toString(CryptoJS.enc.Utf8)}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),Message=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"send",value:function(){var e=document.getElementById("chat__message"),t=firebase.auth().currentUser.email;if(""!=e.value)return firebase.database().ref("messages/").push({date:Date(),user:t,message:Encryption.encrypt(e.value,t)}).key,e.value="",!1}},{key:"update",value:function(e,t){var n=document.getElementById(e),a=document.createElement("div"),r=document.createElement("span"),l=document.createElement("span"),o=document.createElement("span");a.className="msg",r.className="date",l.className="user",o.className="content";var s=new Date(t.date);s=s.getMonth()+1+"/"+s.getDate()+"/"+s.getFullYear();var c=document.createTextNode(t.user),i=document.createTextNode(s),u=document.createTextNode(Encryption.decrypt(t.message,t.user));r.appendChild(i),l.appendChild(c),o.appendChild(u),a.appendChild(l),a.appendChild(r),a.appendChild(o),n.appendChild(a),n.scrollTop=n.scrollHeight}}]),e}(),template=new Template,jwUser=new User,message=new Message,email="";template.empty("main").load("login","main").listen("login",jwUser,"login"),template.load("register","main"),template.load("head_out","head"),firebase.auth().onAuthStateChanged(function(e){e&&(console.log(e.photoURL),template.empty("main").load("chat","main"),template.listen("chat",message,"send"),template.empty("head").load("head_in","head"),template.listen("head_in",jwUser,"logout"),firebase.database().ref("messages/").on("child_added",function(e){message.update("chat__messages",e.val())}))});